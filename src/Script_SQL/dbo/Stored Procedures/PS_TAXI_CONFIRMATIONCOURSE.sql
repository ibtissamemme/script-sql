CREATE PROCEDURE [dbo].[PS_TAXI_CONFIRMATIONCOURSE]
	@ID_COURSE INT,
	@USERID NVARCHAR(14),
	@NUMCOURSE NVARCHAR(35),
	@REFERENCESTAXI NVARCHAR(200),
	@DELAI INT,
	@ADRESSEID NVARCHAR(14)
AS
	DECLARE @STATUTCOURSE NVARCHAR(35)
	DECLARE @COMPAGNIE NVARCHAR(80)
	DECLARE @NOW DATETIME
	DECLARE @EID NVARCHAR(14)
	DECLARE @EVNMT NVARCHAR(200)
BEGIN
	SET @NOW = CURRENT_TIMESTAMP

	UPDATE COURSE SET ID_STATUTCOURSE = -2, DATEMAJ = @NOW, NUMCOURSE = @NUMCOURSE, REFERENCESTAXI = @REFERENCESTAXI, DELAI = @DELAI, ADRESSEID = @ADRESSEID WHERE ID_COURSE = @ID_COURSE
	SET @STATUTCOURSE = (SELECT LIBELLE FROM STATUTCOURSE WHERE ID_STATUTCOURSE = -2)
	SET @COMPAGNIE = (SELECT SOCIETE FROM ADRESSE WHERE ADRESSEID = @ADRESSEID)
	SET @EVNMT = 'COURSE CONFIRMEE PAR LA COMPAGNIE '+@COMPAGNIE
	EXEC PS_TAXI_CREATIONEVENEMENT @ID_COURSE, @EVNMT, @NOW, @USERID, @EID OUTPUT
END