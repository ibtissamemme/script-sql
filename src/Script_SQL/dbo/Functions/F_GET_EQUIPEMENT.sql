CREATE FUNCTION [dbo].[F_GET_EQUIPEMENT](@CODESALLE NVARCHAR(14)) RETURNS NVARCHAR(8000)
AS
BEGIN
DECLARE @EQUIPEMENTFIXE NVARCHAR(8000)
SELECT @EQUIPEMENTFIXE = COALESCE(@EQUIPEMENTFIXE + ', ', '') +
	ISNULL(EQ.LIBELLE, '')
	FROM SALLE SAL
	LEFT OUTER JOIN LGSALLE EQS ON EQS.CODESALLE=SAL.CODESALLE
	LEFT OUTER JOIN EQUIPEMENTFIXE EQ ON EQS.CODEEQUIPEMENTFIXE=EQ.CODEEQUIPEMENTFIXE WHERE SAL.CODESALLE=@CODESALLE

	RETURN (SELECT SUBSTRING(@EQUIPEMENTFIXE,1,8000))
END